#!/bin/sh
#
# Ubuntu (and most likely Debian) uses this file instead of `.xinitrc' one.
# Currently I don't call `startx' or `i3wm' here because it's handled by
# my Ubuntu.

# Update X resources db.
[[ -f ~/.Xresources ]] && xrdb -merge -I$HOME ~/.Xresources

# Ctrl key position: Caps Lock as Ctrl
setxkbmap us,ru
setxkbmap -model pc105
setxkbmap -variant ",winkeys"
setxkbmap -option "ctrl:swapcaps,compose:ralt,terminate:ctrl_alt_bksp"
sleep 2 && xbindkeys

# Start screensaver daemon
xscreensaver -no-splash &

# Restore the background on the next session
if [ -f "${HOME}/.fehbg" ]; then
    chmod +x "${HOME}/.fehbg"
    "${HOME}/.fehbg" &
fi

# Set the cursor icon
xsetroot -cursor_name left_ptr &

# Multiple monitors settings
# TODO: Works on home only. Make it better.
monitors=$(xrandr --listmonitors | grep Monitors | cut -d ' ' -f2)
if [ $monitors -gt '1' ]; then
    source ~/.bash_aliases
    dual
fi

# The urxvt daemon is disbaled for now because
# I'm experimenting with Gnome Terminal
# urxvtd -q -f -o &

# dropbox daemon
dropbox start &

nm-applet &
